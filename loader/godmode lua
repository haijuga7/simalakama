-- GodMode Module
local GodMode = {}

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

-- Variabel state
GodMode.enabled = false
GodMode.connection = nil

function GodMode:Initialize()
    self:CreateUI()
end

function GodMode:CreateUI()
    if not UI or not UI.contentFrame then return end
    
    -- GodMode toggle
    local godToggle = Instance.new("TextButton")
    godToggle.Size = UDim2.new(0, 40, 0, 20)
    godToggle.Position = UDim2.new(1, -40, 0, 145)
    godToggle.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    godToggle.Text = "OFF"
    godToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
    godToggle.Font = Enum.Font.GothamBold
    godToggle.TextSize = 12
    godToggle.Parent = UI.contentFrame
    godToggle.Name = "GodToggle"
    local godToggleCorner = Instance.new("UICorner")
    godToggleCorner.CornerRadius = UDim.new(0, 10)
    godToggleCorner.Parent = godToggle

    local godLabel = Instance.new("TextLabel")
    godLabel.Text = "God Mode"
    godLabel.Size = UDim2.new(0.7, 0, 0, 20)
    godLabel.Position = UDim2.new(0, 0, 0, 145)
    godLabel.BackgroundTransparency = 1
    godLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    godLabel.Font = Enum.Font.Gotham
    godLabel.TextSize = 14
    godLabel.TextXAlignment = Enum.TextXAlignment.Left
    godLabel.Parent = UI.contentFrame
end

function GodMode:ToggleButton(btn, state)
    if state then
        btn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        btn.Text = "ON"
    else
        btn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        btn.Text = "OFF"
    end
end

function GodMode:Toggle()
    self.enabled = not self.enabled
    self:ToggleButton(UI.contentFrame:FindFirstChild("GodToggle"), self.enabled)

    if self.enabled then
        local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if hum then hum.Health = math.huge end

        self.connection = RunService.Stepped:Connect(function()
            local char = LocalPlayer.Character
            if char then
                local hum = char:FindFirstChildOfClass("Humanoid")
                if hum then
                    -- Isi darah penuh terus
                    if hum.Health < hum.MaxHealth then
                        hum.Health = hum.MaxHealth
                    end
                end

                -- Tambahan: isi Hunger & Thirst terus
                if LocalPlayer:FindFirstChild("Hunger") then
                    LocalPlayer.Hunger.Value = 100
                end
                if LocalPlayer:FindFirstChild("Thirst") then
                    LocalPlayer.Thirst.Value = 100
                end
                local gui = LocalPlayer:FindFirstChild("PlayerGui")
                if gui then
                    local bar = gui:FindFirstChild("HungerAndHealthBar", true)
                    if bar and bar:FindFirstChild("Hunger") then
                        bar.Hunger.Size = UDim2.new(1, 0, 1, 0)
                    end
                end
            end
        end)
    else
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
    end
end

function GodMode:ApplySettings()
    if self.enabled then
        self:Toggle()
    end
end

return GodMode
